import{r as e,j as t}from"./vendor-react-DYPeng9G.js";import{B as s,s as a,t as l}from"./index-0LlzAmpO.js";import{m as i,X as n,u as r,a0 as c,a1 as o,a2 as d,a3 as m,a4 as p,J as x,a5 as u,q as h,_ as g}from"./vendor-ui-DYDeDtSQ.js";import{g as b}from"./clientUtils-CA0eKa9v.js";import{C as j}from"./ConfirmationModal-CduQsMHX.js";import"./vendor-supabase-DEEIiAjM.js";const f=({client:a,onSubmit:l,onCancel:p})=>{const[x,u]=e.useState({type:"individual",firstName:"",lastName:"",company:"",email:"",phone:"",address:"",city:"",postalCode:"",country:"France",notes:""});e.useEffect(()=>{a&&u({type:a.type||"individual",firstName:a.firstName||a.first_name||"",lastName:a.lastName||a.last_name||"",company:a.company||"",email:a.email||"",phone:a.phone||"",address:a.address||"",city:a.city||"",postalCode:a.postalCode||a.postal_code||"",country:a.country||"France",notes:a.notes||""})},[a]);const h=e=>{const{name:t,value:s}=e.target;u(e=>({...e,[t]:s}))};return t.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t.jsxs(i.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-slate-800 border border-slate-700 rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:a?"Modifier le Client":"Nouveau Client"}),t.jsx(s,{variant:"ghost",size:"icon",onClick:p,className:"text-slate-400 hover:text-white",children:t.jsx(n,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),l(x)},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Type de client"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"type",value:"individual",checked:"individual"===x.type,onChange:h,className:"text-purple-500 focus:ring-purple-500"}),t.jsx(r,{className:"w-4 h-4 text-slate-400"}),t.jsx("span",{className:"text-slate-300",children:"Particulier"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"type",value:"company",checked:"company"===x.type,onChange:h,className:"text-purple-500 focus:ring-purple-500"}),t.jsx(c,{className:"w-4 h-4 text-slate-400"}),t.jsx("span",{className:"text-slate-300",children:"Entreprise"})]})]})]}),"company"===x.type?t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[t.jsx(c,{className:"w-4 h-4 inline mr-2"}),"Nom de l'entreprise *"]}),t.jsx("input",{type:"text",name:"company",value:x.company,onChange:h,required:!0,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Ex: SARL Martin & AssociÃ©s"})]}):t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Nom *"}),t.jsx("input",{type:"text",name:"lastName",value:x.lastName,onChange:h,required:!0,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Dupont"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"PrÃ©noms *"}),t.jsx("input",{type:"text",name:"firstName",value:x.firstName,onChange:h,required:!0,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Jean"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[t.jsx(o,{className:"w-4 h-4 inline mr-2"}),"Email *"]}),t.jsx("input",{type:"email",name:"email",value:x.email,onChange:h,required:!0,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"jean.dupont@email.com"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[t.jsx(d,{className:"w-4 h-4 inline mr-2"}),"TÃ©lÃ©phone *"]}),t.jsx("input",{type:"tel",name:"phone",value:x.phone,onChange:h,required:!0,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"01 23 45 67 89"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:[t.jsx(m,{className:"w-4 h-4 inline mr-2"}),"Adresse"]}),t.jsx("input",{type:"text",name:"address",value:x.address,onChange:h,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"123 Rue de la RÃ©publique"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Ville"}),t.jsx("input",{type:"text",name:"city",value:x.city,onChange:h,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Paris"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Code Postal"}),t.jsx("input",{type:"text",name:"postalCode",value:x.postalCode,onChange:h,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"75001"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Pays"}),t.jsx("input",{type:"text",name:"country",value:x.country,onChange:h,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"France"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Notes"}),t.jsx("textarea",{name:"notes",value:x.notes,onChange:h,rows:4,className:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Notes additionnelles sur le client..."})]}),t.jsxs("div",{className:"flex gap-4 pt-6",children:[t.jsx(s,{type:"submit",className:"flex-1 bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700",children:a?"Mettre Ã  jour":"Ajouter le client"}),t.jsx(s,{type:"button",variant:"outline",onClick:p,className:"flex-1 border-slate-600 text-slate-300 hover:bg-slate-700",children:"Annuler"})]})]})]})})},y=({client:e,index:a,onEdit:l,onDelete:n})=>{return t.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*a},className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-lg p-6 hover:border-slate-600/50 transition-all duration-200",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 lg:gap-6 items-start",children:[t.jsxs("div",{className:"lg:col-span-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"text-blue-400",children:(h=e.type,"company"===h?t.jsx(c,{className:"w-4 h-4"}):t.jsx(r,{className:"w-4 h-4"}))}),t.jsx("h4",{className:"text-lg font-semibold text-white line-clamp-1",children:b(e)})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-slate-700/50 text-slate-300 border border-slate-600/30",children:(e=>"company"===e?"Entreprise":"Particulier")(e.type)}),e.clientCode&&t.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-600/20 text-indigo-300 border border-indigo-500/30",children:["NÂ° ",e.clientCode]})]})]}),t.jsx("div",{className:"lg:col-span-1",children:e.email&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{className:"w-4 h-4 text-slate-400 flex-shrink-0"}),t.jsx("span",{className:"text-slate-300 text-sm truncate",children:e.email})]})}),t.jsx("div",{className:"lg:col-span-1",children:e.phone&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(d,{className:"w-4 h-4 text-slate-400 flex-shrink-0"}),t.jsx("span",{className:"text-slate-300 text-sm",children:e.phone})]})}),t.jsx("div",{className:"lg:col-span-1",children:e.city&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(m,{className:"w-4 h-4 text-slate-400 flex-shrink-0"}),t.jsxs("span",{className:"text-slate-300 text-sm truncate",children:[e.postalCode&&`${e.postalCode} `,e.city]})]})}),t.jsxs("div",{className:"lg:col-span-1 flex flex-col lg:items-end gap-3",children:[t.jsxs("div",{className:"text-xs text-slate-400",children:["AjoutÃ© le ",(u=e.createdAt,u?new Date(u).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):"N/A")]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(s,{variant:"ghost",size:"sm",onClick:()=>l(e),className:"text-slate-400 hover:text-white hover:bg-slate-700/50",children:t.jsx(p,{className:"w-4 h-4"})}),t.jsx(s,{variant:"ghost",size:"sm",onClick:()=>n(e.id),className:"text-red-400 hover:text-red-300 hover:bg-red-500/20",children:t.jsx(x,{className:"w-4 h-4"})})]})]})]}),e.notes&&t.jsx("div",{className:"mt-4 pt-4 border-t border-slate-700/50",children:t.jsx("p",{className:"text-sm text-slate-400 italic",children:e.notes})})]});var u,h},N=({clients:e,onClose:a})=>{const l=()=>(new Date).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"});return t.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 print:bg-white print:block print:relative print:p-0 print:m-0",children:[t.jsxs(i.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white border border-gray-300 rounded-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto print:max-w-none print:max-h-none print:border-0 print:rounded-0 print:shadow-none print:overflow-visible",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 print:hidden",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Impression des Clients"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs(s,{onClick:()=>{globalThis.print()},className:"bg-blue-600 hover:bg-blue-700 text-white",children:[t.jsx(u,{className:"w-4 h-4 mr-2"}),"Imprimer"]}),t.jsx(s,{variant:"ghost",size:"icon",onClick:a,className:"text-gray-500 hover:text-gray-700",children:t.jsx(n,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{className:"p-6 print:p-0 print:m-0",children:[t.jsxs("div",{className:"hidden print:block mb-8 text-center",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Liste des Clients"}),t.jsxs("p",{className:"text-gray-600 text-lg",children:["Cabinet Juridique - ",l()]}),t.jsx("hr",{className:"mt-4 border-gray-300"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 print:grid-cols-3 print:gap-6 print:mb-6",children:[t.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-white print:border print:border-gray-300",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Clients"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),t.jsx(r,{className:"w-6 h-6 text-blue-500 print:hidden"})]})}),t.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-white print:border print:border-gray-300",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Entreprises"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"company"===e.type).length})]}),t.jsx(c,{className:"w-6 h-6 text-green-500 print:hidden"})]})}),t.jsx("div",{className:"bg-gray-50 p-4 rounded-lg print:bg-white print:border print:border-gray-300",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Particuliers"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"individual"===e.type).length})]}),t.jsx(r,{className:"w-6 h-6 text-purple-500 print:hidden"})]})})]}),t.jsxs("div",{className:"space-y-4 print:space-y-2",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4 print:text-lg print:mb-3",children:["DÃ©tail des Clients (",e.length,")"]}),e.map((e,s)=>t.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 print:border print:border-gray-400 print:rounded-none print:p-3 print:mb-2 print:break-inside-avoid",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 print:grid-cols-4 print:gap-2",children:[t.jsxs("div",{className:"print:col-span-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:["company"===e.type?t.jsx(c,{className:"w-4 h-4 text-blue-500 print:hidden"}):t.jsx(r,{className:"w-4 h-4 text-purple-500 print:hidden"}),t.jsx("span",{className:"text-xs text-gray-500 uppercase font-medium print:text-[10px]",children:"company"===e.type?"Entreprise":"Particulier"})]}),t.jsx("h4",{className:"font-semibold text-gray-900 print:text-sm print:font-bold",children:"company"===e.type?e.company:`${e.first_name} ${e.last_name}`}),"company"===e.type&&e.first_name&&t.jsxs("p",{className:"text-sm text-gray-600 print:text-xs",children:["Contact: ",e.first_name," ",e.last_name]})]}),t.jsxs("div",{className:"print:col-span-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(o,{className:"w-4 h-4 text-gray-400 print:hidden"}),t.jsx("span",{className:"text-xs text-gray-500 uppercase font-medium print:text-[10px]",children:"Email"})]}),t.jsx("p",{className:"text-sm text-gray-900 break-all print:text-xs",children:e.email||"Non renseignÃ©"})]}),t.jsxs("div",{className:"print:col-span-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(d,{className:"w-4 h-4 text-gray-400 print:hidden"}),t.jsx("span",{className:"text-xs text-gray-500 uppercase font-medium print:text-[10px]",children:"TÃ©lÃ©phone"})]}),t.jsx("p",{className:"text-sm text-gray-900 print:text-xs",children:e.phone||"Non renseignÃ©"})]}),t.jsxs("div",{className:"print:col-span-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(m,{className:"w-4 h-4 text-gray-400 print:hidden"}),t.jsx("span",{className:"text-xs text-gray-500 uppercase font-medium print:text-[10px]",children:"Adresse"})]}),t.jsx("p",{className:"text-sm text-gray-900 print:text-xs",children:e.address&&t.jsxs(t.Fragment,{children:[e.address,e.city&&t.jsxs(t.Fragment,{children:[", ",e.city]}),e.postal_code&&t.jsxs(t.Fragment,{children:[" ",e.postal_code]}),e.country&&"France"!==e.country&&t.jsxs(t.Fragment,{children:[", ",e.country]})]})||"Non renseignÃ©e"})]})]}),e.notes&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 print:mt-2 print:pt-2",children:[t.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium mb-1 print:text-[10px]",children:"Notes"}),t.jsx("p",{className:"text-sm text-gray-600 print:text-xs",children:e.notes})]})]},e.id))]}),t.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t border-gray-300 text-center",children:t.jsxs("p",{className:"text-xs text-gray-500",children:["Document gÃ©nÃ©rÃ© le ",l()," - Cabinet Juridique - Page ","{page}"," sur ","{pages}"]})})]})]}),t.jsx("style",{children:'\n        @media print {\n          * {\n            -webkit-print-color-adjust: exact !important;\n            color-adjust: exact !important;\n          }\n          \n          @page {\n            size: A4;\n            margin: 1.5cm;\n            @top-center {\n              content: "Liste des Clients - Cabinet Juridique";\n            }\n            @bottom-center {\n              content: counter(page) " / " counter(pages);\n            }\n          }\n          \n          body {\n            font-size: 12px;\n            line-height: 1.4;\n          }\n          \n          .print\\:break-inside-avoid {\n            break-inside: avoid;\n          }\n          \n          .print\\:text-xs {\n            font-size: 10px;\n          }\n          \n          .print\\:text-sm {\n            font-size: 11px;\n          }\n          \n          .print\\:text-lg {\n            font-size: 14px;\n          }\n          \n          .print\\:text-\\[10px\\] {\n            font-size: 8px;\n          }\n        }\n      '})]})},v=()=>{const[n,o]=e.useState([]),[d,m]=e.useState(!1),[p,x]=e.useState(null),[v,w]=e.useState(""),[C,k]=e.useState(!1),[_,E]=e.useState({open:!1,title:"",message:"",onConfirm:null});e.useEffect(()=>{z()},[]);const z=async()=>{const{data:e,error:t}=await a.from("clients").select("*").order("created_at",{ascending:!1});if(t)l({variant:"destructive",title:"Erreur",description:"Impossible de charger les clients."});else{const t=e.map(e=>({...e,name:b(e),clientCode:e.client_code,firstName:e.first_name,lastName:e.last_name,postalCode:e.postal_code,createdAt:e.created_at}));o(t)}},L=n.filter(e=>{const t=v.toLowerCase();return e.first_name?.toLowerCase().includes(t)||e.last_name?.toLowerCase().includes(t)||e.email?.toLowerCase().includes(t)||e.company?.toLowerCase().includes(t)||e.phone?.includes(v)});return t.jsxs("div",{className:"space-y-6",id:"client-manager-section",children:[t.jsxs("div",{className:"flex items-center justify-between print:hidden",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Gestion des Clients"}),t.jsx("p",{className:"text-slate-400",children:"GÃ©rez votre portefeuille client"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(s,{variant:"outline",onClick:()=>{k(!0)},children:[t.jsx(u,{className:"w-4 h-4 mr-2"})," Imprimer"]}),t.jsxs(s,{onClick:()=>{x(null),m(!0)},className:"bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700",children:[t.jsx(h,{className:"w-4 h-4 mr-2"}),"Nouveau Client"]})]})]}),t.jsxs("div",{className:"print:hidden grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm",children:"Total Clients"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:n.length})]}),t.jsx(r,{className:"w-8 h-8 text-purple-400"})]})}),t.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm",children:"Entreprises"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:n.filter(e=>"company"===e.type).length})]}),t.jsx(c,{className:"w-8 h-8 text-blue-400"})]})}),t.jsx(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-400 text-sm",children:"Particuliers"}),t.jsx("p",{className:"text-3xl font-bold text-white",children:n.filter(e=>"individual"===e.type).length})]}),t.jsx(r,{className:"w-8 h-8 text-green-400"})]})})]}),t.jsx("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700/50 rounded-xl p-6 print:hidden",children:t.jsxs("div",{className:"relative",children:[t.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:"Rechercher un client par nom, email, tÃ©lÃ©phone ou entreprise...",value:v,onChange:e=>w(e.target.value),className:"w-full pl-12 pr-4 py-3 bg-slate-700/50 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})}),t.jsxs("div",{className:"hidden lg:grid lg:grid-cols-5 gap-4 px-6 py-3 bg-slate-900/50 backdrop-blur-sm rounded-lg border border-slate-700/50 text-sm text-slate-400 font-medium",children:[t.jsx("div",{children:"Nom & Type"}),t.jsx("div",{children:"Email"}),t.jsx("div",{children:"TÃ©lÃ©phone"}),t.jsx("div",{children:"Ville"}),t.jsx("div",{children:"Date & Actions"})]}),t.jsx("div",{className:"space-y-4",children:L.map((e,s)=>t.jsx(y,{client:e,index:s,onEdit:e=>{x(e),m(!0)},onDelete:e=>{const t=n.find(t=>t.id===e);E({open:!0,title:"Supprimer le client",message:`Voulez-vous vraiment supprimer le client "${t?.name}" ?\n\nCette action est irrÃ©versible.`,onConfirm:()=>{(async e=>{const{error:t}=await a.from("clients").delete().eq("id",e);t?l({variant:"destructive",title:"Erreur",description:"Impossible de supprimer le client."}):(o(n.filter(t=>t.id!==e)),l({title:"ðŸ—‘ï¸ Client supprimÃ©",description:"Le client a Ã©tÃ© supprimÃ© avec succÃ¨s."}))})(e),E({..._,open:!1})}})}},e.id))}),0===L.length&&t.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 print:hidden",children:[t.jsx(r,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-slate-400 mb-2",children:"Aucun client trouvÃ©"}),t.jsx("p",{className:"text-slate-500",children:v?"Essayez de modifier votre recherche":"Commencez par ajouter votre premier client"})]}),d&&t.jsx(f,{client:p,onSubmit:p?async e=>{try{if("company"===e.type){if(!e.company||!e.email)return void l({variant:"destructive",title:"Erreur",description:"Le nom de l'entreprise et l'email sont obligatoires."})}else if(!e.firstName||!e.lastName||!e.email)return void l({variant:"destructive",title:"Erreur",description:"Les champs prÃ©nom, nom et email sont obligatoires."});let t;t="company"===e.type?e.company?.trim()||"Entreprise sans nom":`${e.firstName?.trim()||""} ${e.lastName?.trim()||""}`.trim()||"Inconnu";const s={type:e.type,name:t,first_name:e.firstName||null,last_name:e.lastName||null,company:e.company||null,email:e.email,phone:e.phone,address:e.address,city:e.city,postal_code:e.postalCode,country:e.country,notes:e.notes},{data:i,error:r}=await a.from("clients").update(s).eq("id",p.id).select();if(r)return void l({variant:"destructive",title:"Erreur",description:"Impossible de modifier le client. VÃ©rifiez les champs et rÃ©essayez."});const c={...i[0],name:b(i[0]),firstName:i[0].first_name,lastName:i[0].last_name,postalCode:i[0].postal_code,createdAt:i[0].created_at};o(n.map(e=>e.id===p.id?c:e)),x(null),m(!1),l({title:"âœ… Client modifiÃ©",description:"Les informations du client ont Ã©tÃ© mises Ã  jour."})}catch(t){l({variant:"destructive",title:"Erreur",description:"Impossible de modifier le client."})}}:async e=>{try{if("company"===e.type){if(!e.company||!e.email)return void l({variant:"destructive",title:"Erreur",description:"Le nom de l'entreprise et l'email sont obligatoires."})}else if(!e.firstName||!e.lastName||!e.email)return void l({variant:"destructive",title:"Erreur",description:"Les champs prÃ©nom, nom et email sont obligatoires."});let t;t="company"===e.type?e.company?.trim()||"Entreprise sans nom":`${e.firstName?.trim()||""} ${e.lastName?.trim()||""}`.trim()||"Inconnu";const s={type:e.type,name:t,first_name:e.firstName||null,last_name:e.lastName||null,company:e.company||null,email:e.email,phone:e.phone,address:e.address,city:e.city,postal_code:e.postalCode,country:e.country,notes:e.notes},{data:i,error:r}=await a.from("clients").insert([s]).select();if(r)return void l({variant:"destructive",title:"Erreur",description:"Impossible d'ajouter le client. VÃ©rifiez les champs et rÃ©essayez."});const c={...i[0],name:b(i[0]),firstName:i[0].first_name,lastName:i[0].last_name,postalCode:i[0].postal_code,createdAt:i[0].created_at};o([c,...n]),m(!1),l({title:"âœ… Client ajoutÃ©",description:"Le nouveau client a Ã©tÃ© ajoutÃ© avec succÃ¨s."})}catch(t){l({variant:"destructive",title:"Erreur",description:"Impossible d'ajouter le client."})}},onCancel:()=>{m(!1),x(null)}}),C&&t.jsx(N,{clients:n,onClose:()=>k(!1)}),t.jsx(j,{open:_.open,onOpenChange:e=>E({..._,open:e}),title:_.title,message:_.message,onConfirm:_.onConfirm})]})};export{v as default};
